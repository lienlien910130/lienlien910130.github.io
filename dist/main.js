(()=>{"use strict";window.addEventListener("load",(()=>{let e,t,n;liff.init({liffId:"1660857311-QDo3BLk3",withLoginOnExternalBrowser:!0}).then((()=>{let a,i,d,o,c,l;a=liff.getLanguage(),i=liff.getVersion(),d=liff.isInClient(),o=liff.isLoggedIn(),c=liff.getOS(),l=liff.getLineVersion();const s=document.getElementById("result-basic");s.value=`語言: ${a}\nLIFF SDK Version: ${i}\nisInClient: ${d}\n是否登入: ${o}\n作業系統: ${c}\nLine Version: ${l}`,liff.getProfile().then((e=>{s.value+=`\nUserId: ${e.userId}\nDisplayName: ${e.displayName}`;const t=liff.getDecodedIDToken().email;s.value+=`\nemail: ${t}`})),document.getElementById("qrScan").addEventListener("click",(()=>{o&&liff.scanCode?liff.scanCodeV2().then((a=>{document.getElementById("result-qr").value=a.value,fetch("https://1851255c-6a66-400a-8682-69454cae4f53.mock.pstmn.io/forum23/rsvp/api/qr-verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:a.value})}).then((e=>e.json())).then((a=>{console.log(a),document.getElementById("appendButton").innerHTML="";var i=document.getElementById("result-api");if(0==a.success)i.innerHTML="無效";else{e=!1!==a.data.checked,t=a.data.id,n=a.data.created;var d=e?"已檢查":"未檢查";i.innerHTML=`<br/>${d}<br/>id: ${t}<br/>姓名: ${a.data.name}<br/>手機: ${a.data.mobile}<br/>建立時間: ${n}`,e?i.innerHTML+=`<br/>檢查時間: ${a.data.checked}<br/>檢查人員: ${a.data.checked_by}`:(document.getElementById("appendButton").innerHTML='<button id="checkIn" type="button" class="btn btn-success" style="width:10%">通關</button>',document.getElementById("checkIn").addEventListener("click",(()=>{fetch("https://1851255c-6a66-400a-8682-69454cae4f53.mock.pstmn.io/forum23/rsvp/api/check-in",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t,created:n})}).then((e=>e.json())).then((e=>{document.getElementById("appendButton").innerHTML='<span style="padding:0px">成功</span>'})).catch((e=>{console.log("錯誤:",e)}))})))}})).catch((e=>{console.log("錯誤:",e)}))})).catch((e=>{document.getElementById("result-qr").value=e})):alert("請先登入Line")}))})).catch((e=>{console.log(e)}))}))})();