(()=>{"use strict";window.addEventListener("load",(()=>{let e,n,t;liff.init({liffId:"1660857311-QDo3BLk3"}).then((()=>{let i,a,l,o,c,d;i=liff.getLanguage(),a=liff.getVersion(),l=liff.isInClient(),o=liff.isLoggedIn(),c=liff.getOS(),d=liff.getLineVersion();const s=document.getElementById("result-basic");s.value=`語言: ${i}\nLIFF SDK Version: ${a}\nisInClient: ${l}\n是否登入: ${o}\n作業系統: ${c}\nLine Version: ${d}`,o?liff.getProfile().then((e=>{s.value+=`\nUserId: ${e.userId}\nDisplayName: ${e.displayName}`;const n=liff.getDecodedIDToken().email;s.value+=`\nemail: ${n}`})):liff.login({redirectUri:"https://lienlien910130.github.io"}).then((()=>{liff.getProfile().then((e=>{s.value+=`\nUserId: ${e.userId}\nDisplayName: ${e.displayName}`;const n=liff.getDecodedIDToken().email;s.value+=`\nemail: ${n}`}))})),document.getElementById("qrScan").addEventListener("click",(()=>{o&&liff.scanCode?liff.scanCodeV2().then((i=>{document.getElementById("result-qr").value=i.value,fetch("https://1851255c-6a66-400a-8682-69454cae4f53.mock.pstmn.io/forum23/rsvp/api/qr-verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:i.value})}).then((e=>e.json())).then((i=>{console.log(i);var a=document.getElementById("result-api");0==i.success?a.innerHTML="無效":(e=!1!==i.data.checked,n=i.data.id,t=i.data.created,a.innerHTML=`<br/>id: ${n}<br/>姓名: ${i.data.name}<br/>手機: ${i.data.mobile}<br/>建立時間: ${t}`,e?a.innerHTML+=`<br/>檢查時間: ${i.data.checked}<br/>檢查人員: ${i.data.checked_by}`:(document.getElementById("appendButton").innerHTML='<button id="checkIn" type="button" class="btn btn-success">通關</button>',document.getElementById("checkIn").addEventListener("click",(()=>{fetch("https://1851255c-6a66-400a-8682-69454cae4f53.mock.pstmn.io/forum23/rsvp/api/check-in",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:n,created:t})}).then((e=>e.json())).then((e=>{document.getElementById("appendButton").innerHTML="<span>成功</span>"})).catch((e=>{console.log("錯誤:",e)}))}))))})).catch((e=>{console.log("錯誤:",e)}))})).catch((e=>{document.getElementById("result-qr").value=e})):alert("請先登入Line")}))})).catch((e=>{console.log(e)}))}))})();